------------------------------------------0408--------------------------------------------

CREATE TABLE CUSTOMER(
	CUST_CD VARCHAR(10) NOT NULL,
	CUST_NM VARCHAR(20) NOT NULL,
	CUST_AGE INT DEFAULT 0,
	CUST_LVL VARCHAR(10),
	CUST_JOB VARCHAR(20),
	CUST_POINT INT DEFAULT 0,
	PRIMARY KEY (CUST_CD),
	CHECK (CUST_AGE <= 60)
);


CREATE TABLE PRODUCTS(
	PROD_CD VARCHAR(10) NOT NULL,
	PROD_NM VARCHAR(20) NOT NULL,
	PROD_QY INT DEFAULT 0,
	PROD_PRI DECIMAL(18,4) DEFAULT 0,
	PROD_VEND VARCHAR(20),
	PRIMARY KEY (PROD_CD)
);

CREATE TABLE ORDERS(
	ORD_CD VARCHAR(10) NOT NULL,
	CUST_CD VARCHAR(10),
	PROD_CD VARCHAR(10) DEFAULT 0,
	ORDER_QTY INT, 
	ORDER_ADD VARCHAR(20),
	ORDER_REGDT DATETIME DEFAULT GETDATE(),
	PRIMARY KEY (ORD_CD),
	FOREIGN KEY (CUST_CD) REFERENCES CUSTOMER(CUST_CD),
	FOREIGN KEY (PROD_CD) REFERENCES PRODUCTS(PROD_CD)
);


SELECT * FROM CUSTOMER;
SELECT * FROM PRODUCTS;
SELECT* FROM ORDERS;


ALTER TABLE CUSTOMER ADD CUST_DAY DATE;
ALTER TABLE CUSTOMER DROP COLUMN CUST_DAY;

ALTER TABLE ORDERS ADD CONSTRAINT CHK_QTY CHECK(ORDER_QTY <= PRODUCTS.PROD_QY);
-- Q. CHECK 제약조건 설정시 다른 테이블의 값과 비교할 수 있없? WHY?
-- Q. PRODUCTS(PROD_QY) 와 PRODUCTS.PROD_QY 의 차이?


ALTER TABLE PRODUCTS ADD CONSTRAINT QY_LIMIT CHECK(PROD_QY >= 0 AND PROD_QY <= 10000);


CREATE TABLE VENDERS(
	VEND_CD VARCHAR(10) NOT NULL,
	VEND_NM VARCHAR(20),
	VEND_PRD VARCHAR(10),
	VEND_PHONE VARCHAR(20),
	PRIMARY KEY (VEND_CD),
	FOREIGN KEY (VEND_PRD) REFERENCES PRODUCTS(PROD_CD)
);
SELECT *FROM VENDERS;
DROP TABLE VENDERS;


INSERT INTO CUSTOMER(CUST_CD, CUST_NM, CUST_AGE, CUST_LVL, CUST_JOB, CUST_POINT)
VALUES('GG', 'GRACE', 25, 'VIP', 'DOCTOR', 5000);
INSERT INTO CUSTOMER(CUST_CD, CUST_NM, CUST_AGE, CUST_LVL, CUST_JOB, CUST_POINT)
VALUES('AYLE', 'ALEX', 20, 'GOLD', 'TEACHER', 3000);
INSERT INTO CUSTOMER(CUST_CD, CUST_NM, CUST_AGE, CUST_LVL, CUST_JOB, CUST_POINT)
VALUES('K27', 'KALLY', 27, 'SILVER', 'ENGINEER', 2500);
INSERT INTO CUSTOMER(CUST_CD, CUST_NM, CUST_AGE, CUST_LVL, CUST_JOB)
VALUES('WATERMELON', 'LUKE', 30, 'BRONZE', 'SINGER');
INSERT INTO CUSTOMER(CUST_CD, CUST_NM, CUST_AGE, CUST_LVL, CUST_JOB, CUST_POINT)
VALUES('HIDORA', 'DORA', 23, 'VIP', 'NURSE', 5000);
INSERT INTO CUSTOMER(CUST_CD, CUST_NM, CUST_AGE, CUST_LVL, CUST_JOB, CUST_POINT)
VALUES('APPLE', '정소화', 20, 'GOLD', 'STUDENT', 1000);
INSERT INTO CUSTOMER(CUST_CD, CUST_NM, CUST_AGE, CUST_LVL, CUST_JOB, CUST_POINT)
VALUES('BANANA', '김선우', 25, 'VIP', 'NURSE', 2500);
INSERT INTO CUSTOMER(CUST_CD, CUST_NM, CUST_AGE, CUST_LVL, CUST_JOB, CUST_POINT)
VALUES('CARROT', '고명석', 28, 'GOLD', 'TEACHER', 4500);
INSERT INTO CUSTOMER(CUST_CD, CUST_NM, CUST_LVL, CUST_JOB)
VALUES('ORANGE', '김용욱', 'SILVER', 'STUDENT');
INSERT INTO CUSTOMER(CUST_CD, CUST_NM, CUST_AGE, CUST_LVL, CUST_JOB, CUST_POINT)
VALUES('MELON', '성원용', 35, 'GOLD', 'OFFICER', 5000);


INSERT INTO PRODUCTS(PROD_CD, PROD_NM, PROD_QY, PROD_PRI, PROD_VEND)
VALUES('P01', 'DUMPLING', 5000, 4500, '대한식품');
INSERT INTO PRODUCTS(PROD_CD, PROD_NM, PROD_QY, PROD_PRI, PROD_VEND)
VALUES('P02', 'SPICY NOODLE', 2500, 5500, '민국푸드');
INSERT INTO PRODUCTS(PROD_CD, PROD_NM, PROD_QY, PROD_PRI, PROD_VEND)
VALUES('P03', 'RICE PIE', 3600, 2600, '한빛제과');
INSERT INTO PRODUCTS(PROD_CD, PROD_NM, PROD_QY, PROD_PRI, PROD_VEND)
VALUES('P04', 'CHOCOLATE', 1250, 2500, '한빛제과');
INSERT INTO PRODUCTS(PROD_CD, PROD_NM, PROD_QY, PROD_PRI, PROD_VEND)
VALUES('P05', 'RAMEN', 2200, 1200, '대한식품');
INSERT INTO PRODUCTS(PROD_CD, PROD_NM, PROD_QY, PROD_PRI, PROD_VEND)
VALUES('P06', 'UDONG', 1000, 1550, '민국푸드');
INSERT INTO PRODUCTS(PROD_CD, PROD_NM, PROD_QY, PROD_PRI, PROD_VEND)
VALUES('P07', 'BISCUIT', 1650, 1500, '한빛제과');


INSERT INTO ORDERS(ORD_CD, CUST_CD, PROD_CD, ORDER_QTY, ORDER_ADD)
VALUES('O01', 'APPLE', 'P03', 10, '서울시 마포구');
INSERT INTO ORDERS(ORD_CD, CUST_CD, PROD_CD, ORDER_QTY, ORDER_ADD)
VALUES('O02', 'MELON', 'P01', 5, '충청북도 보은군');
INSERT INTO ORDERS(ORD_CD, CUST_CD, PROD_CD, ORDER_QTY, ORDER_ADD)
VALUES('O03', 'BANANA', 'P06', 45, '인천시 계양구');
INSERT INTO ORDERS(ORD_CD, CUST_CD, PROD_CD, ORDER_QTY, ORDER_ADD)
VALUES('O04', 'CARROT', 'P02', 8, '경기도 부천시');
INSERT INTO ORDERS(ORD_CD, CUST_CD, PROD_CD, ORDER_QTY, ORDER_ADD)
VALUES('O05', 'BANANA', 'P06', 36, '부산시 금정구');
INSERT INTO ORDERS(ORD_CD, CUST_CD, PROD_CD, ORDER_QTY, ORDER_ADD)
VALUES('O06', 'HIDORA', 'P01', 19, '경기도 용인시');
INSERT INTO ORDERS(ORD_CD, CUST_CD, PROD_CD, ORDER_QTY, ORDER_ADD)
VALUES('O07', 'AYLE', 'P03', 22, '서울시 영등포구');
INSERT INTO ORDERS(ORD_CD, CUST_CD, PROD_CD, ORDER_QTY, ORDER_ADD)
VALUES('O08', 'K27', 'P02', 50, '강원도 춘천시');
INSERT INTO ORDERS(ORD_CD, CUST_CD, PROD_CD, ORDER_QTY, ORDER_ADD)
VALUES('O09', 'BANANA', 'P04', 15, '전라남도 목포시');
INSERT INTO ORDERS(ORD_CD, CUST_CD, PROD_CD, ORDER_QTY, ORDER_ADD)
VALUES('O10', 'HIDORA', 'P03', 20, '경기도 안양시');


SELECT CUST_CD, CUST_NM, CUST_LVL FROM CUSTOMER;

SELECT PROD_VEND FROM PRODUCTS;

SELECT ALL PROD_VEND FROM PRODUCTS;
SELECT ALL CUST_CD FROM ORDERS;

--중복값은 제외된 속성
SELECT DISTINCT PROD_VEND FROM PRODUCTS;
SELECT DISTINCT CUST_CD FROM ORDERS;

SELECT PROD_NM, PROD_PRI AS PRICE FROM PRODUCTS;

SELECT * FROM PRODUCTS WHERE PROD_VEND = '한빛제과';

SELECT PROD_CD, ORDER_QTY, ORDER_REGDT FROM ORDERS WHERE CUST_CD = 'BANANA' AND ORDER_QTY <=15;
SELECT PROD_CD, ORDER_QTY, ORDER_REGDT FROM ORDERS WHERE CUST_CD = 'BANANA' OR ORDER_QTY >= 15;
SELECT PROD_CD, PROD_PRI, PROD_VEND FROM PRODUCTS WHERE PROD_PRI >= 2000 AND PROD_PRI <= 3000;
--SELECT PROD_CD, PROD_PRI, PROD_VEND FROM PRODUCTS WHERE 2000 <= PROD_PRI <= 3000; 이렇게는 안됨


SELECT CUST_NM, CUST_AGE, CUST_LVL, CUST_POINT FROM CUSTOMER WHERE CUST_NM LIKE '김%';
SELECT CUST_CD, CUST_NM, CUST_LVL FROM CUSTOMER WHERE CUST_CD LIKE '_____';
SELECT CUST_NM FROM CUSTOMER WHERE CUST_AGE = 0;

SELECT CUST_NM, CUST_LVL, CUST_AGE FROM CUSTOMER ORDER BY CUST_AGE DESC;
SELECT CUST_CD, PROD_CD, ORDER_QTY, ORDER_REGDT FROM ORDERS WHERE ORDER_QTY >=10 ORDER BY PROD_CD ASC, ORDER_QTY DESC;

SELECT AVG(PROD_PRI) FROM PRODUCTS;
SELECT SUM(PROD_QY) FROM PRODUCTS WHERE PROD_VEND = '한빛제과';
SELECT COUNT(CUST_CD) FROM CUSTOMER;
SELECT COUNT(CUST_AGE) FROM CUSTOMER;
-- COUNT 할때 NULL 값이 들어간 데이터는 포함되지 않는다. 

--SELECT DISTINCT COUNT(PROD_VEND) FROM PRODUCTS;
SELECT COUNT(DISTINCT PROD_VEND) FROM PRODUCTS;
SELECT COUNT(DISTINCT CUST_JOB) FROM CUSTOMER;